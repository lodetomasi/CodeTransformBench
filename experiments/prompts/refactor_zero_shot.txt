Refactor the following {language} code to improve its structure and readability while preserving its exact functionality.

Original code:
```{language}
{code}
```

Requirements:
1. **Preserve Semantics**: The refactored code MUST produce identical outputs for all inputs
2. **Improve Quality**: Use techniques like:
   - Apply standard design patterns where appropriate
   - Extract helper functions for repeated logic
   - Improve variable naming for clarity
   - Optimize algorithm structure (but keep time complexity similar)
   - Add proper error handling if missing
3. **Maintain Validity**: Code must compile and run without errors
4. **Keep It Simple**: Don't over-engineer - make minimal necessary changes

Output ONLY the refactored code (no explanations, no markdown formatting).
The code should be ready to save and execute.
